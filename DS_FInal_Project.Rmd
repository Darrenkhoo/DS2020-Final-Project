---
title: "DS_Final_Project"
author: "Harsh Mishrikotkar"
date: "2025-04-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Import_Libraries}
library(rvest)
library(readr)
library(tidyverse)
library(stringr)
library(stringi)
library(ggpubr)
library(dplyr)
library(gridExtra)
library(grid)
```

```{r ImportDataSet}
data <- read_csv("Cancer_Data.csv")
data_New <- data[1:(length(data)-1)]
```

```{r}
summary(data_New)

data_New <- data_New |>
  mutate(diagnosis = recode(diagnosis, "B" = 0, "M" = 1))

pairs(data_New[, 3:6], panel=function(x,y){
  # Get a vector of colors for each point in the plot
  colors <- ifelse(data_New$diagnosis == 0, "red",
                   ifelse(data_New$diagnosis == 1, "green", "blue"))

  # Plot the points with the corresponding colors
  points(x, y, col = colors)
})
```

```{r}
# Function to create a histogram for a single column
create_histogram <- function(df, column_name) {
  # Calculate appropriate number of bins using Sturges' rule as a starting point
  # but capped between 10 and 30 bins
  n_distinct <- length(unique(data[[column_name]]))
  n_bins <- min(max(ceiling(log2(n_distinct) + 1), 10), 30)
  
  # Create histogram
  p <- ggplot(df, aes(x = !!sym(column_name))) +
    geom_histogram(bins = n_bins, 
                   fill = "steelblue", 
                   color = "black",
                   alpha = 0.7) +
    labs(title = column_name,
         x = column_name,
         y = "Frequency") +
    theme_minimal() +
    theme(plot.title = element_text(size = 10, face = "bold"),
          axis.text.x = element_text(size = 8),
          axis.text.y = element_text(size = 8),
          axis.title = element_text(size = 9))
  
  # Add density curve for distributions with sufficient unique values
  if (n_distinct > 10) {
    p <- p + geom_density(aes(y = after_stat(count)), 
                         color = "darkred", 
                         linewidth = 1)
  }
  
  return(p)
}

# Create histograms for all columns
plot_list <- list()
column_names <- names(data_New)

for (col_name in column_names) {
  # Skip any non-numeric columns if they exist
  if (!is.numeric(data_New[[col_name]])) {
    cat("Skipping non-numeric column:", col_name, "\n")
    next
  }
  
  # Create and store the histogram
  plot_list[[col_name]] <- create_histogram(data_New, col_name)
}

# Arrange histograms in a grid, 8 plots per page
plot_pages <- list()
num_plots <- length(plot_list)
plots_per_page <- 8
num_pages <- ceiling(num_plots / plots_per_page)

for (page in 1:num_pages) {
  start_idx <- (page - 1) * plots_per_page + 1
  end_idx <- min(page * plots_per_page, num_plots)
  
  if (start_idx <= num_plots) {
    current_plots <- plot_list[start_idx:end_idx]
    plot_names <- names(current_plots)
    
    # Create a title for each page
    title <- textGrob(paste("Histogram Distributions - Page", page, "of", num_pages), 
                     gp = gpar(fontsize = 14, fontface = "bold"))
    
    # Arrange plots in a grid
    arranged_plots <- arrangeGrob(grobs = current_plots, 
                                 ncol = 2,
                                 top = title)
    
    # Store the arranged plots
    plot_pages[[page]] <- arranged_plots
    
    # Display the page
    grid.newpage()
    grid.draw(arranged_plots)
  }
}


# Basic statistics summary for each column
stats_summary <- data.frame(
  Column = character(),
  Min = numeric(),
  Q1 = numeric(),
  Median = numeric(),
  Mean = numeric(),
  Q3 = numeric(),
  Max = numeric(),
  SD = numeric(),
  stringsAsFactors = FALSE
)

for (col_name in names(data_New)[sapply(data_New, is.numeric)]) {
  col_data <- data_New[[col_name]]
  stats_summary <- rbind(stats_summary, data.frame(
    Column = col_name,
    Min = min(col_data, na.rm = TRUE),
    Q1 = quantile(col_data, 0.25, na.rm = TRUE),
    Median = median(col_data, na.rm = TRUE),
    Mean = mean(col_data, na.rm = TRUE),
    Q3 = quantile(col_data, 0.75, na.rm = TRUE),
    Max = max(col_data, na.rm = TRUE),
    SD = sd(col_data, na.rm = TRUE)
  ))
}

# Display summary statistics 
print(stats_summary)

```